# ü§ñ Telegram Bot Setup - –ì–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É!

## ‚úÖ –ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ

Telegram –±–æ—Ç –¥–ª—è Telegram Marketplace Mini App –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

### üìÅ –§–∞–π–ª—ã –±–æ—Ç–∞:
- **`telegram_bot.py`** - –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞
- **`test_bot.py`** - –°–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **`run_bot.sh`** - –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞
- **`TELEGRAM_BOT_GUIDE.md`** - –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

#### üéØ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞:
- `/start` - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π –æ—Ç–∫—Ä—ã—Ç–∏—è Mini App
- `/pay package_id` - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
- `‚ùì –ü–æ–º–æ—â—å` - –°–ø—Ä–∞–≤–∫–∞ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é (–∫–Ω–æ–ø–∫–∞)

#### üí∞ –ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Payments API
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–≤–æ–π—Å–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —É—Å–ø–µ—à–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ backend –æ –ø–ª–∞—Ç–µ–∂–∞—Ö

#### üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Backend:
- API endpoint: `POST /api/packages/confirm-payment`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è —Ç–∞—Ä–∏—Ñ–æ–≤
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### 1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º:
```bash
cd /app
python test_bot.py
```

### 2. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞:
```bash
# –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä—è–º–æ–π –∑–∞–ø—É—Å–∫
python telegram_bot.py

# –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç
./run_bot.sh
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:
1. –ù–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞ –≤ Telegram: **@eWork_Robot**
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/start`
3. –ù–∞–∂–º–∏—Ç–µ "üöÄ –û—Ç–∫—Ä—ã—Ç—å –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å"
4. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π —Å –ø–ª–∞—Ç–Ω—ã–º–∏ —Ç–∞—Ä–∏—Ñ–∞–º–∏

## üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã):
```env
TELEGRAM_BOT_TOKEN="7554067474:AAG75CqnZSiqKiWgpZ4zX6hNW_e6f9uZn1g"
TELEGRAM_PAYMENTS_TOKEN="1744374395:TEST:703d48b8cac170d51296"
REACT_APP_BACKEND_URL="https://958e1ad6-00a3-4c3e-a8b5-fdd4fba26a4a.preview.emergentagent.com"
```

### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ:
- **–ò–º—è:** @eWork_Robot
- **ID:** 7554067474
- **–¢–∏–ø:** Test Bot (—Ç–µ—Å—Ç–æ–≤—ã–µ –ø–ª–∞—Ç–µ–∂–∏)

## üí≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã:
1. **–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π** - 0 RUB (—Ç–µ—Å—Ç: `/pay free-package`)
2. **–°—Ç–∞–Ω–¥–∞—Ä—Ç** - 100 RUB (—Ç–µ—Å—Ç: `/pay standard-package`)
3. **–° —Ñ–æ—Ç–æ** - 150 RUB (—Ç–µ—Å—Ç: `/pay photo-package`)
4. **–í—ã–¥–µ–ª–µ–Ω–∏–µ** - 200 RUB (—Ç–µ—Å—Ç: `/pay highlight-package`)
5. **–ë–æ–ª—å—à–µ –ø–æ–∫–∞–∑–æ–≤** - 300 RUB (—Ç–µ—Å—Ç: `/pay boost-package`)

### –¢–µ—Å—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞ (–¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π):
```
–ù–æ–º–µ—Ä: 4242 4242 4242 4242
–î–∞—Ç–∞: –ª—é–±–∞—è –±—É–¥—É—â–∞—è
CVC: –ª—é–±–æ–π
```

## üìä –õ–æ–≥–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –±–æ—Ç–∞:
```bash
# –õ–æ–≥–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —á–µ—Ä–µ–∑ python
python telegram_bot.py

# –ò–ª–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏
journalctl -f -u telegram-bot  # –µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–∞–∫ —Å–µ—Ä–≤–∏—Å
```

### –õ–æ–≥–∏ backend (–¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π):
```bash
tail -f /var/log/supervisor/backend.out.log
```

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ü–æ—Ç–æ–∫ –ø–ª–∞—Ç–µ–∂–µ–π:
1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å** –Ω–∞–∂–∏–º–∞–µ—Ç "–°–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ" –≤ Mini App
2. **Mini App** –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤—ã–±—Ä–∞—Ç—å —Ç–∞—Ä–∏—Ñ
3. **Backend** —Å–æ–∑–¥–∞–µ—Ç –ø–ª–∞—Ç–µ–∂ –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç payload
4. **Telegram Bot** —Å–æ–∑–¥–∞–µ—Ç invoice
5. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å** –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç —á–µ—Ä–µ–∑ Telegram
6. **Bot** –ø–æ–ª—É—á–∞–µ—Ç successful_payment
7. **Bot** —É–≤–µ–¥–æ–º–ª—è–µ—Ç Backend —á–µ—Ä–µ–∑ API
8. **Backend** –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ç–∞—Ä–∏—Ñ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–æ–≤
GET /api/categories/all

# –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
POST /api/packages/confirm-payment
{
  "user_id": "123",
  "package_id": "premium",
  "telegram_charge_id": "xxx",
  "provider_charge_id": "yyy",
  "amount": 100.0,
  "currency": "RUB"
}
```

## üéâ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É!

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ‚úÖ Telegram Bot –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å Backend API —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
- ‚úÖ –ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- ‚úÖ Mini App –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –í—Å–µ API endpoints –æ—Ç–≤–µ—á–∞—é—Ç

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å:
1. **TELEGRAM_PAYMENTS_TOKEN** –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π (–Ω–µ TEST)
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook –≤–º–µ—Å—Ç–æ polling
3. –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω—ã–π —Å–µ—Ä–≤–∏—Å

## üí° –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –†–∞—Å—à–∏—Ä–µ–Ω–∏—è (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å):
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏—è—Ö
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —á–µ—Ä–µ–∑ –±–æ—Ç–∞
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –ø–ª–∞—Ç–µ–∂–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∞–¥–º–∏–Ω–æ–≤:
```python
# –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –±—É–¥—É—â–µ–º
/admin_stats - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
/admin_users - –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
/admin_payments - –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
```

---

**üöÄ –ë–æ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤! –ó–∞–ø—É—Å–∫–∞–π—Ç–µ –∏ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ!**

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `python test_bot.py` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.